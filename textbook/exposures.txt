Exposure Coding Rulebook
Aryn Castle, Jim Shields, Varun Deedwaniya

Objective: Clearly detail the process for coding, running, and verifying report-level data for a particular client, fund, and date. 

Contents
Exposure Process Overview	2
Hawkeye: Selecting a client and fund	2
Exposure Model	3
Opening the Exposure Model	3
Importing Data Templates	3
Original Data Tab Set-Up	4
Coding the Exposure Template	5
The Data Template	5
Purple Rows	7
Identifying Purple Rows	7
Identifying Critical Data in Purple Rows	7
Fund Exposure, Fund Performance, AUM, Concentration Duplicate Data Check	13
Category Exposure and Category Attribution Duplicate Data Check	15
Rolling Forward Hard-Coded Data	18
Rolling Forward Formulas	19
Running the Exposure Model:	20
Data Validation:	22


 
Exposure Process Overview
	
The processing stage of the overall exposure process involves scraping data from a variety of “source files”, including PDFs, Excel files, emails, and images, and ultimately transforming that data into a standardized format to be presented on the Novus Alpha Platform. Exposures are run on a regular basis (either monthly or quarterly in most cases) for each manager in which our allocator clients are invested.
There are 3 major steps in the exposure process: 
1.	Receiving the source files
2.	Entering the data from the source files into Excel data templates
3.	Transforming the data templates into a format that can be input to our SQL database
This rulebook will cover the third step of this process.
Hawkeye: Selecting a client and fund

Inputs: Client Code (i.e. NV1), Primary/Secondary/Senior stage to run
Outputs: Client Code, Fund Code, Report Date
1)	Navigate to the N:\Novus\Analytics\ALL LIVE MODELS folder
2)	Open up the model named “INTRANET_Hawkeye 1.41”
3)	Enter the Client Code into Cell B3 and click the red “Show” button in cell B9. You can ignore the “Fund Code”, “Start Date”, “End Date”, and “Portfolio View” cells.
 

4)	Click on the dropdown arrow on Cell J11 (“Pending”) and select only the Primary/Secondary/Senior stage you are running. This will filter the view for only the selected client and stage.
5)	For each row, the client code (column A), fund code (column C), and report date (column F) will be the 3 outputs listed above and determine what you will run in the exposure model. Keep this model open as you use the exposure model.

NOTE: If you need to change the view (for example, pull data for another client) it is critical that you click the “Filters OFF” button (cell J3-4) before changing the view. It will fail otherwise.
 
Exposure Model
Opening the Exposure Model

1)	Navigate to the N:\Novus\Analytics\ALL LIVE MODELS folder
2)	Open up the model named “Novus_Exposure_Individual_4.2.13_BradValidation2” (or newer version as specified by Novus).
a.	Click “Yes” when you receive the prompt to open as read-only.
b.	Click “Don’t Update” when you receive the prompt that begins with “This workbook contains links to one or more external sources…”
c.	The model will now automatically import market data that is necessary to run the analysis. Once it is finished retrieving data, it will say “Ready” and “Calculate” in the bottom left hand corner of the model.

Importing Data Templates

Inputs: Client Code (i.e. NV1), Fund Code, Report Date, Primary/Secondary/Senior stage to run
Outputs: “Not Approved” Data Template

1)	Use the outputs from Hawkeye as the inputs below:
a.	Enter the client code, in Cell D11. 
i.	If you receive this error: “Run-time error ‘13’: Type mismatch”:
1.	You have entered a client code that does not exist in our database. Click “End” and go back to the “Control” tab, and re-enter the correct client code.
ii.	If you receive no error, proceed to the next step. 
b.	Enter the fund code and report date in Cells D12 and D13. 
c.	Enter your name in Cell D14
d.	Enter the relevant stage in Cell D17 (Primary, Secondary, or Senior). 
e.	For now, ignore cells D15 & D16. 

 

2)	Click the “IMPORT” button in cell G12 (just to the right of the “IMPORT & RUN” button).
a.	If the template imported correctly, proceed to the next step.
b.	If you receive this error: “[relevant fund name]/[blank] was not found in NOT APPROVED folder! Would you like to import and work on template from APPROVED?”:
i.	Click “No” and double-check that the inputs you entered in column D are accurate. 
ii.	If everything is accurate and you still receive this message when clicking “IMPORT”, notify a member of the Novus team and we will look into it.

Original Data Tab Set-Up
1)	Once the data template is imported correctly, the model should take you to the “OriginalData” tab. 
2)	You will need to “freeze panes” within excel to view the template properly.
a.	Find the row with “Source” in Column A (generally between Row 10-20)
b.	This row will contain exposure dates starting in Column Q
c.	In the Cell below the 1st exposure date in Column Q, freeze panes (Alt w+f+f)
3)	In the row with exposure dates, scroll right until finding the cell that matches the initial input Report Date.
4)	At this point, the model is open and the template has been imported, so proceed to the next section, “Coding the Exposure Template”.
 
Coding the Exposure Template

Inputs: “Not Approved” Data Template
Outputs: Updated “Not Approved” Data Template that is ready to run

Note: “Critical” data points are defined as anything that appears on the Novus Taxonomy spreadsheet.
Note: A row is “coded” if there is a value in the NOV1 column other than “NC” or “MISC.”

The Data Template

Prior to doing anything with the template, read this description of each of the columns in the template. Each column represents settings, codes, supporting information, or data points that will directly affect the output of the process.
•	Source (A): This column identifies the source file from which the row of data is entered. The source files are found in N:\Aranca\Exposures\Queue\Finished\[Client Code].

•	Settings (B–F):

•	MULT – MULT stands for multiplier. Use this column any time you need to multiply the values in columns Q and beyond by a fixed multiplier. For example, if a value is provided in hundreds of thousands, but you need it in millions, you would enter 10 into the MULT column.
•	BASIS – The BASIS column is used to either denote the formatting of MISC data, or to set the value in the specified row as a component in a further calculation. MISC formatting includes Percent, Date, Number, and Decimal. Calculations need to be used in tandem with the REF column, which is explained in the next section. They include:
o	 “% of” - Use when the values in the section that the specified row is in add to 100% (values must be presented as percentages). This will specify that the value in the row will be taken as a percentage of whatever category is in the REF column (explained next).
o	“Part of” – Use when the values in the section that the specified row is in are presented in dollar terms (not percentages) and need to be converted to percentage terms by dividing them by whatever category is in the REF column (explained next).
o	“Diff” – a;dsljf
o	“Catch” – 
o	“Subt” – asdf
•	REF – REF denotes the value that is the other part of the BASIS equation. You can plug any other code into the REF column, such as EXPO, OAUF, AEQY, etc. For example, if a value is reported in dollars and you wanted to convert it to exposure percentage, you could use “Part of” in the BASIS column, and OAUF in the REF column. That would take the Value and divide it by the fund AUM and return the appropriate exposure percentage.
•	CURR – The CURR column is used to denote the currency of the supplied value (if not USD). Examples of CURR would be EUR, CAD, etc. All available currency codes are in column R of the Definitions tab.
•	UNITS – This column specifies the units of the supplied value. If left blank, the default is “Ones”. Other examples include Thousands, Billions, etc.

•	NOV 1-5 (G–K): Novus taxonomy codes are entered in these columns. NOV1 must be filled in for every row with data. NOV2-5 can be used to make additional assumptions about the data in a row.

•	CALC (L): This is used to account for overlapping data streams for AUM, performance, and exposure. If there is a “2” in this column, that row will be used as the secondary data stream for the associated NOV1 code. (See instructions for more detail.)

•	Types (M): This determines the direction of the data stream.

o	L: Long. Used for exposure, performance, attribution, concentration.
o	S: Short. Used for exposure, performance, attribution, concentration.
o	G: Gross. Used for exposure, performance, attribution, concentration. If long and short exposure is provided, code that, and not gross and net exposure. 
o	N: Net. Used for exposure and performance. If long and short exposure is provided, code that, and not gross and net exposure.
o	O: Other. Used for any data that does not fall into the above categories. If exposure, performance, attribution, or concentration data has this type, it will not work correctly.
o	V: Variable. Used only for exposure data, and only when the data stream changes between positive and negative over time. This is very rarely used.
o	A: Arbitrage. Used only for exposure data, and only when the exposure number provided should be split in half – half being long exposure, and half being short exposure. This is extremely rare, and is almost always limited to arbitrage funds.

•	Category (N): This is where Aranca enters the name of the broadest possible category for the data. In many cases, this is a name of a particular table of data.

•	Subcategory (O): This is where Aranca enters the name of the more specific category for the data. In many cases, this is a name of a particular column in a table of data. This column is especially important as it will feed directly into the output of this process.

•	Other (P): Any additional information about the data stream (for example, whether the performance number is MTD, YTD, or ITD). 

•	Data (Q–end of sheet): This is where Aranca enters data points associated with each row. It is organized by month – each column is a month – and goes from left to right (earliest is left, latest is right). In only rare cases (e.g., incorrectly-entered data) should this be manipulated in any way.
Purple Rows

The majority of the work in this process involves “coding” the Data Template so that all “critical” data points are accurately coded within the Novus taxonomy. As noted above, a “critical” data point is one that fits into any of the Level 1 categories on the Novus Taxonomy sheet (provided). In order for the row of data points to be processed correctly, it must be coded correctly. In many cases, most rows in a data template will already be coded. 
When there are new types of data in a fund’s source files, “Purple Rows” are generated in the data template – these indicate rows of data that must be coded. New types of data include a new source file, a new section within an existing source file, or new categories or line items within an existing section of a source file. A purple row will be highlighted purple in Columns M:P.
Identifying Purple Rows

1)	Scroll through the entire template looking for Purple Rows (Columns M:P highlighted purple, example below):
 
2)	If there are no purple rows, advance to the next major step titled “Rolling Forward Hard-Coded Data”
3)	If there are purple rows:
a.	If the purple row has already been coded, leave it as is and move to the next purple row.
4)	If it has not been coded, identify to which of the following cases the row belongs. Use this case to select which steps to follow in the sections below:
i.	Entirely new section
ii.	New row within existing section
Note: A section is defined as a continuous set of rows in the data template.

Identifying Critical Data in Purple Rows

1)	Check the source document to determine if this data is “Critical”, as defined above.
a.	If not critical:
i.	Determine if this data is still useful, despite not being in the exposure taxonomy. Examples include contact information, liquidity information, etc.
1.	If useful:
a.	Enter “MISC” into the NOV1 column
b.	If the data is in percent format, enter “Percent” into the BASIS column.
c.	If the data is in a date format, enter “Date” into the Basis Column
2.	If not useful:
a.	Enter “NC” into the NOV1 column and move on to the next purple row.
b.	If critical:
i.	Given the information in columns N:P and the source file, use the “Taxonomy Overview” tab under the Exposure Taxonomy sheet to determine which Level 1 Category the data falls under. These categories include:
1.	Fund Exposure
2.	Fund Performance
3.	AUM
4.	Category Exposure
5.	Category Attribution
6.	Concentration
ii.	Please use the selected Level 1 category throughout the rest of the Purple Rows section.
 
Fund Exposure

These are the most important data points. It is critical that total long and short exposure is captured for a fund. If this is not a brand new template, it is likely that it has already been coded.
1)	The applicable NOV1 taxonomy code will be “EXPO”
2)	Determine the applicable “Type” code, meaning L/S/G/N
3)	Using these NOV1 and Type codes as inputs, jump to the “Fund Exposure, Fund Performance, AUM, Concentration Duplicate Data Check” section. Once completed, come back to this step.
4)	If the row was not coded as “NC” during the Duplicate section, enter the “Exposure Row Settings” in Columns B:F as follows:
a.	Determine if the value provided is already in the correct format (percentage, nothing needs to be altered). If so, nothing needs to be entered in columns B:F. 
i.	If the value provided needs to be altered, you will need to determine how to convert it from what’s provided to what’s needed. This may be done several different ways using the MULT, BASIS, REF, CURR, or UNITS columns.
1.	The most common Fund Exposure adjustment is “Part of”, which is used when exposure is given in a dollar value, and must be divided by the AUM of the fund to determine exposure percentage. 

Fund Performance

1)	The applicable NOV1 taxonomy code will be “PER”
2)	Determine the applicable “Type” code, meaning L/S/G/N
3)	Using these NOV1 and Type codes as inputs, jump to the “Fund Exposure, Fund Performance, AUM, Concentration Duplicate Data Check” section. 
4)	If the row was not coded as “NC” during the Duplicate section, enter the “Exposure Row Settings” in Columns B:F as follows:
a.	Determine if the value provided is already in the correct format (percentage, nothing needs to be altered). If so, nothing needs to be entered in columns B:F. 
i.	If the value provided needs to be altered, you will need to determine how to convert it from what’s provided to what’s needed. This may be done several different ways using the MULT, BASIS, REF, CURR, or UNITS columns.
1.	For fund performance, the most common adjustment is to use “bps” in the UNITS column, which you would use when the performance is given in basis points.
AUM

1)	Determine if this is Fund, Strategy, or Firm AUM data
a.	If Firm AUM, the applicable NOV1 taxonomy code will be “OAUT”
b.	If Strategy AUM, the applicable NOV1 taxonomy code will be “OAUS”
c.	If Fund AUM, use the “SubCategory” value (Column O) to determine if the same Fund AUM data is coded elsewhere in the document.
i.	If yes, the applicable NOV1 taxonomy code will match what is in the NOV1 Column for the already-coded row
ii.	If no, check to see if there are any codes beginning with “OAUF” in the template. 
1.	If there are none, the applicable NOV1 taxonomy code will be “OAUF”.
2.	If “OAUF” codes exist, the applicable NOV1 taxonomy code will be “OAUF_”, with the “_” representing the lowest number not already appearing as an “OAUF” code in the template.
2)	The applicable “Type” code will be “O”
3)	Using these NOV1 and Type codes as inputs, jump to the “Fund Exposure, Fund Performance, AUM, Concentration Duplicate Data Check” section. 
4)	If the row was not coded as “NC” during the Duplicate section, enter the “Exposure Row Settings” in Columns B:F as follows:
a.	Determine if the value provided is already in the correct format. If so, nothing needs to be entered in columns B:F. 
i.	If the value provided needs to be altered, you will need to determine how to convert it from what’s provided to what’s needed. This may be done several different ways using the MULT, BASIS, REF, CURR, or UNITS columns.
1.	For AUM, the most common adjustments used are CURR and UNITS adjustments. If the AUM is provided in a different currency that USD, enter the correct currency code in the CURR column. If the AUM is provided in any units other than ones, enter the correct units in the UNITS column.

Category Exposure
			Entirely New Section
Probably need to add part if section is responsible for 2 or more categories
1)	Determine which Level 2 category the section falls under: Asset Class (A), Geography (G), Industry (I), Market Cap (M), Strategy (S).
2)	Determine the applicable “Type” code, meaning L/S/G/N
3)	Using the Level 2 Category and Type codes as inputs, jump to the “Category Exposure and Category Attribution Duplicate Data Check” section.
4)	If the section was not coded as “NC” during the Duplicate section:
a.	For each row, look up the subcategory in the corresponding Category tab in the Exposure Taxonomy sheet. Enter the matching Novus Code in the NOV1 column
b.	Enter the “Type” from step 2 in the Type Column
c.	Enter the “Exposure Row Settings” In Columns B:F as follow:
i.	Determine if the value provided is already in the correct format. If so, nothing needs to be entered in columns B:F. 
1.	If the value provided needs to be altered, you will need to determine how to convert it from what’s provided to what’s needed. This may be done several different ways using the MULT, BASIS, REF, CURR, or UNITS columns.
a.	For category exposures, the most common adjustments in columns B:F will be made in the MULT, BASIS and REF columns.
New Row within Existing Section
1)	If the rest of the existing section is coded as “NC” or “MISC”, do the same for this row.
2)	Check if this subcategory means the same as any other subcategory already coded in this section. 
a.	This generally means new pluralization, abbreviation, or detail.
b.	Make the Subcategory column (Column O) consistent for the existing and new rows.
i.	Unless the new row is “better” (not abbreviated, provides more detail, etc.), select the existing row’s subcategory as the standard value. 
ii.	Before making the change, move the existing subcategory value from the row(s) being changed to the “Other” column
iii.	Finally, paste the selected subcategory value into each row’s SubCategory column
c.	Copy all of the Exposure and Setting Codes from columns B:M from the existing row into the new row. Verify that the “settings” from Columns B:F apply to the new row
3)	Otherwise, you must enter an exposure code for any column between NOV1 and NOV4 that is coded for the other rows in the section.
a.	Starting with NOV1, identify what Level 2 Category is being coded. This comes from the 1st letter of the code (A/G/I/M/S).
b.	Use the corresponding Category tab in the Exposure Taxonomy sheet to match the subcategory with a Novus Exposure Code
c.	Enter this code into the NOV1 column
d.	Repeat steps a-c for each column between NOV2-NOV4 
e.	Copy any “settings” from Columns B:F, along with the Type in Column M, from this section to the new row. Verify that they all apply to the new row
Category Attribution

Entirely New Section
1)	Determine which Level 2 category the section falls under: Asset Class (A), Geography (G), Industry (I), Market Cap (M), Strategy (S).
2)	Determine the applicable “Type” code, meaning L/S/G/N
3)	Using the Level 2 Category and Type codes as inputs, jump to the “Category Exposure and Category Attribution Duplicate Data Check” section.
4)	If the section was not coded as “NC” during the Duplicate section:
a.	For each row, look up the subcategory in the corresponding Category tab in the Exposure Taxonomy sheet. Enter the matching Novus Code in the NOV5 column
b.	Enter the “Type” from step 2 in the Type Column
c.	Enter the “Exposure Row Settings” In Columns B:F as follows:
i.	Determine if the value provided is already in the correct format. If so, nothing needs to be entered in columns B:F. 
1.	If the value provided needs to be altered, you will need to determine how to convert it from what’s provided to what’s needed. This may be done several different ways using the MULT, BASIS, REF, CURR, or UNITS columns.
a.	Similar to Performance, the most common adjustment is to use “bps” in the UNITS column, which you would use when the performance is given in basis points.
New Row within Existing Section
1)	If the rest of the existing section is coded as “NC” or “MISC”, do the same for this row.
2)	Check if this subcategory has the same meaning as any other subcategory already coded in this section. 
a.	This generally means new pluralization, abbreviation, or detail.
b.	Make the Subcategory column (Column O) consistent for the existing and new rows.
i.	Unless the new row is “better” (not abbreviated, provides more detail, etc.), select the existing row’s subcategory as the standard value. 
ii.	Before making the change, move the existing subcategory value from the row(s) being changed to the “Other” column
iii.	Finally, paste the selected subcategory value into each row’s SubCategory column
c.	Copy all of the Exposure and Setting Codes from columns B:M from the existing row into the new row. Verify that the “settings” from Columns B:F apply to the new row
3)	Otherwise, copy the NOV1 and Type codes from the rest of the section into this row.
a.	Based on the category from the NOV1, identify what Level 2 Category is being coded. This comes from the last letter of the code (A/G/I/M/S).
b.	Use the corresponding Category tab in the Exposure Taxonomy sheet to match the subcategory with a Novus Exposure Code
c.	Enter this code into the NOV5 column
d.	Copy any “settings” from Columns B:F from this section to the new row. Verify that they all apply to the new row
Concentration

1)	Check if it is Long, Short, or if applicable (for ONUMB), G. Enter the corresponding (L/S/G) code into the Type column (Column M) if it is not already correctly entered. If the steps below tell you to enter a code into NOV1, use the appropriate “Concentration” Novus Code in the Exposure Taxonomy sheet.
a.	Once identified, advance to the “Fund Exposure, Fund Performance, AUM, Concentration Duplicate Data Check” section.
b.	Enter the “Exposure Row Settings” In Columns B:F as follows:
i.	Determine if the value provided is already in the correct format. If so, nothing needs to be entered in columns B:F. 
1.	If the value provided needs to be altered, you will need to determine how to convert it from what’s provided to what’s needed. This may be done several different ways using the MULT, BASIS, REF, CURR, or UNITS columns.
a.	The most common adjustments that need to be made for concentration are made in the BASIS and REF columns, if at all.


 
Fund Exposure, Fund Performance, AUM, Concentration Duplicate Data Check

Inputs: Uncoded row; NOV1 and Type codes
		Outputs: Partially Coded row
Duplicate data may exist and already be coded within the data template. This could occur if the data already exists on a different source file or is reported slightly differently within the same source file. The steps below outline how to identify and code duplicate data for these 3 categories.
						
1)	Check to see if there is already an existing row with the input NOV1 code in any of columns NOV1-NOV5, as well as a matching Type code in Column M.
a.	If the same data does not exist elsewhere in the template:
i.	Enter the input NOV1 code into the NOV1 column of the purple row.
ii.	Enter the input Type code into the Type column of the purple row
iii.	Return to the appropriate Category section above
b.	If the same data exists elsewhere in the template, compare the purple row with the existing row(s) for any overlap in months with data.
i.	If there is 100% overlap (the new row only contains duplicate data points) and the previously coded row(s) of data are still to be provided on a monthly basis:
1.	Enter “NC” into the NOV1 column of the new row.
ii.	If there is 0% overlap (the new row only contains historical data not previously received, or there is an exact break between the existing row(s) and the new row):
1.	Enter the input NOV1 code into the NOV1 column of the purple row. 
2.	Enter the input Type code into the Type column of the purple row
3.	Make the Subcategory column (Column O) consistent for the existing and new rows.
a.	Unless the new row is “better” (not abbreviated, provides more detail, etc.), select the existing row’s subcategory as the standard value. 
b.	Before making the change, move the existing subcategory value from the row(s) being changed to the “Other” column
c.	Finally, paste the selected subcategory value into each row’s SubCategory column
iii.	For any other case (between 0 and 100% overlap or 100% overlap but only the new row has data going forward):
1.	Follow the steps from above as if there were 0% overlap for entering codes into the NOV1 and Type columns, along with ensuring Subcategory consistency
2.	If there is only 1 existing similar rows:
a.	1 of the 2 similar rows will need to have a 2 entered in the CALC column (Column L). 
b.	To determine which one, use the following steps:
c.	If only one of the rows will receive data going forward, place the 2 in the other row.
d.	If both rows will receive data going forward, place the 2 in whichever row has fewer historical months of data
3.	If there are 2 or more existing similar rows:
a.	A formula will need to be created at the bottom of the template
b.	Copy the NOV1, Type, Category, SubCategory, and Other Columns from the existing purple row into the formula row
c.	Copy any “Settings” in Columns B:F that are consistent for all rows being compared into the formula row. Make not of any settings unique to a specific row.
d.	Enter a formula into the column with the earliest reported data point for these rows, using the follow formula template:
i.	=IF(A1=””, IF(A2=””, IF(A3=””, “”, A3 * settings), A2 * settings, A1 * settings)
ii.	A1, A2, A3: Replace A with the actual column, and replace 1, 2, and 3 with the actual row numbers.
iii.	“Settings” should be added if there are any settings unique to a specific row. For example, if only row 2 is given in millions, this part of the formula would be A2 * 1,000,00
iv.	For each additional row, replace the central “” with another IF(A_, “”, A_ * settings)
v.	Drag the formula to the right-most exposure date and hit Shift+F9
vi.	Verify the values in the formula row
vii.	Once everything is correct, enter “NC” into each of the rows being combined in the formula and return to the appropriate Category section above
2)	Return to:
a.	Fund Exposure
b.	Fund Performance
c.	AUM
d.	Concentration

Category Exposure and Category Attribution Duplicate Data Check

Inputs: Uncoded row; Level 2 Category, Type code
		Outputs: Partially Coded row

Duplicate data may exist and already be coded within the data template. This could occur if the data already exists on a different source file or is reported slightly differently within the same source file. The steps below outline how to identify and code duplicate data for these 3 categories.

1)	Check to see if the same combination of Level 2 Category and Type is already coded in another section of the template
a.	If not:
i.	If category exposure, do nothing and return to the exposure section
ii.	If category attribution:
1.	Enter the appropriate Level 2 category code in the NOV1 column for each row
a.	The Level 2 Category Code is “PER”, followed by the 1st letter of the Level 2 Category (A/G/I/M/S)
2.	Enter the input Type into the Type Column for each row
b.	If yes:
i.	If there is 100% overlap between the existing section(s) and new section, and the previously coded section(s) of data are still to be provided on a monthly basis:
1.	Enter “NC” into the NOV1 column of the new row.
ii.	If there is 0% overlap (the new section only contains historical data not previously received, or there is an exact break between the existing section(s) and the new section):
1.	If category exposure, do nothing and return to the exposure section
2.	If category attribution:
a.	Enter the appropriate Level 2 category code in the NOV1 column for each row
i.	The Level 2 Category Code is “PER”, followed by the 1st letter of the Level 2 Category (A/G/I/M/S)
b.	Enter the input Type into the Type Column for each row
iii.	For any other case (between 0 and 100% overlap or 100% overlap but only the new section has data going forward):
1.	Create a section of formulas at the bottom of the template by copying everything left of Column P from the new section into the formula section
2.	Select from the below cases:
a.	New section contains historical data not found elsewhere:
i.	Excluding the new section, identify the oldest month for this Level 2 category with data
ii.	Copy ONLY the data from the new section that is older than this date into the formula section
iii.	Add a note at the right most data point of the formula section stating that this data is copied from above and should not be rolled forward at all
b.	New section is the only section receiving data going forward:
i.	For each row in the formula section, enter a formula that sets the cell equal to the corresponding cell in the new section
ii.	Add a note at the left most data point of the formula section stating that this formula should not be rolled backward at all
3.	Enter “NC” to the NOV1 column of the new section
4.	In the formula section:
a.	If category exposure, do nothing and return to the exposure section
b.	If category attribution:
i.	Enter the appropriate Level 2 category code in the NOV1 column for each row
1.	The Level 2 Category Code is “PER”, followed by the 1st letter of the Level 2 Category (A/G/I/M/S)
ii.	Enter the input Type into the Type Column for each row
5.	Return to the appropriate Category section above. Use the formula section instead of the new section from this point on when the new section is referenced.


 
	Rolling Forward Hard-Coded Data

	If there is no data highlighted in yellow, skip step.
	
Occasionally, there is data that is not reported every month. This most frequently occurs when reports are only received on a quarterly basis. In these cases, the old data needs to be “rolled forward” into the missing months in order to fill in the gaps. Any data that has been rolled forward must be clearly marked with a yellow cell background. Example: 

1)	If any row has historical data filled in yellow, follow the steps below:
a.	If the current month has data with no yellow background, that means we have received data for that month. You do not need to roll forward any data into the current month.
b.	If the current month has no data, the previous month’s data will need to be rolled forward unless there is a note clearly noting that the data should not be rolled forward any more. To roll forward data, copy the data from the previous month into the current month and make the background yellow.
 
Rolling Forward Formulas

	If there are no formulas, skip step.

At the bottom of the data template (under where everything from column M on is white), there may be formulas entered in blue text. These formulas must be rolled forward each month unless there is a note clearly stating that a given section should not be rolled forward any more. To roll forward a formula, simply copy and paste the previous month’s formula then press shift+F9.
1)	One case that requires additional steps is if there is a section of formulas being rolled forward which references a section in the template that now has a purple row. 
2)	In this case, you must insert a row at the same relative location within the formula section as it appears in the referenced section. 
3)	Next, you must copy the Category, Subcategory, and Other Columns from the referenced section into the new row. Columns A:F and M should be copied from the rest of the formula section into the new row. Finally, enter the exposure codes into Columns NOV1:NOV5 using the same rules as the “New row within existing section” section of this guide.
4)	Copy the formula from another row within the same section into the current month for the new row. Assuming all of the cell references are locked properly, this should work with no issues. However, please ensure that both the new and previously coded formulas are referencing the correct cells from the referenced section based on the subcategories and exposure codes in columns NOV1:NOV5.
 
Running the Exposure Model:

1)	Running the Exposure model
a.	Once all steps in sections preceding this one have been completed, you are ready to run the exposure model.
b.	Navigate to the “Control” tab of the model and click the “RUN” button in cell G13 (to the right of “IMPORT & RUN” and below “IMPORT”). This will run the exposure model.
i.	If the model runs properly, you will be automatically taken to the “Snapshot” tab of the model. Ensure that the proper fund name and date are reflected in the analysis, and move on to the next section, “Validation”. Auto went to validation
ii.	The model can fail to finish running for several reasons. If the model fails to run, move to step 2.
2)	What to do when the Exposure Model doesn’t run properly
a.	You may get one of several error messages when running the model. Find each of them and their solutions below:
i.	“Diagnostics Failed – Report will not run”
1.	This is the most common reason the model will not run properly, and it can be triggered by several mistakes in the template. If you get this message, navigate to the orange “Diagnostics” tab in the model.
a.	Cell D3 will indicate what is wrong with the template. The most common issues are:
i.	“Some rows are not coded…”
1.	In this case, return to the “OriginalData” tab and ensure that all rows containing data are coded.
ii.	“[Date] Not found in the data…”
1.	In this case, ensure that the date you entered in cell D13 of the “Control” tab matches both the most recent date in row 16 of the “OriginalData” tab as well as the date that is in Hawkeye for the fund you are attempting to process.
ii.	Excel Error
1.	There are a number of Excel errors that could cause the model not to run, freeze, or shut down altogether. A few examples of errors are:
a.	“Not enough memory…”
b.	“Excel is not responding…”
c.	“Cannot complete task with current resources…”
2.	In any of these cases, close the model and reopen. This fixes the problem >95% of the time. If this does not fix the model.
b.	You may notice that in general, as the number of times you run the model increases, the model will take longer to run each time. This effect can be somewhat alleviated by closing and reopening the model. If you find that after 3-6 times of running the model it begins to slow down, please close the model and start back at step 1.
 
Data Validation:

Inputs: “Not Approved” Data Template
Outputs: Validated “Not Approved” Data Template that is ready to move to the next stage

The Validation tab summarizes all data that will be included in the ultimate output file.  
Validating Processed Data:
a.	After the model has run, you should be on the Validation tab.
i.	If not, navigate to the Validation tab.
b.	On row 4, identify all months that are in red.
c.	For each of these months:
i.	Open the source file(s) associated with this client and fund.
1.	These files are found in N:\Aranca\Exposures\Queue\Finished\Client Code\Fund Name.
2.	The necessary files are those listed in the “Source” column in the OriginalData tab.
ii.	In the Validation tab:
1.	Go to the “Fund Exposure” section (highlighted in tan).
a.	Check that L/S/G/N exposure exactly matches the source data.
b.	For the next five groups of data (Differences):
i.	If there are any differences:
1.	Check on the source file(s) that L/S/G/N exposure for the particular category add to numbers that are different than the total L/S/G/N exposure. 
2.	If they are different in the source file:
a.	Navigate to the “OriginalAssump” tab.
b.	Ensure that there is a corresponding assumption. The assumption should start with “Differences: ” and give exactly the reason for the difference.
c.	If there is an assumption:
i.	Move onto the next category.
d.	If there is not an assumption:
i.	Write an assumption in that tab starting with “Differences: “ that explains the reason for the difference.
3.	If they are not different in the source file:
a.	Go back to the OriginalData tab.
b.	Isolate the total exposure (“EXPO”).
c.	Find all codes for the category in question.
d.	Ensure that every data stream in that category is captured.
e.	Ensure that every data point in the coded categories are correct.
ii.	If there are no differences:
1.	Go to the next step.
2.	Go to each “Exposure-Category” section:
a.	Find the corresponding section(s) in the source file(s).
b.	For each subcategory:
i.	Check that L/S/G/N exposure exactly matches the source data.
ii.	If it does not match:
1.	Navigate to the “OriginalData” tab.
2.	Find the corresponding data stream.
3.	Ensure that the coding for that row is correct.
4.	Ensure that the data for that row matches the data in the source file(s).
iii.	If it matches:
1.	Move to the next section.
3.	Go to the “Fund – Performance” section:
a.	For each row in the group titled “Fund: Supplied Only”:
i.	Find the corresponding data point in the source file(s).
ii.	If it does not match:
1.	Navigate to the “OriginalData” tab.
2.	Find the corresponding data stream.
3.	Ensure that the coding for that row is correct.
4.	Ensure that the data for that row matches the data in the source file(s).
iii.	If it matches:
1.	Move to the next section.
b.	For each row in the “Category Differences” groups:
i.	Ignore for now, move to the next section.
4.	Go to the “Attribution – Asset Class” section:
a.	For each “Attribution – Category” section:
i.	Find the corresponding data point in the source file(s).
ii.	If it does not match:
1.	Navigate to the “OriginalData” tab.
2.	Find the corresponding data stream.
3.	Ensure that the coding for that row is correct.
4.	Ensure that the data for that row matches the data in the source file(s).
iii.	If it matches:
1.	Move to the next section.
5.	Go to the “AUM” section:
a.	For each row of AUM data:
i.	Find the corresponding data point in the source file(s).
ii.	If it does not match:
1.	Navigate to the “OriginalData” tab.
2.	Find the corresponding data stream.
3.	Ensure that the coding for that row is correct.
4.	Ensure that the data for that row matches the data in the source file(s).
iii.	If it matches and is a fund AUM (e.g., “OAUFn”)
1.	Ensure that the name of the fund is correct.
2.	If it does not match the fund name in the source file:
a.	Navigate to the “OriginalData” tab.
b.	Find the corresponding data stream.
c.	Change the “SubCategory” column for that row to the name of the fund as indicated in the source file.
3.	If it does match the fund name in the source file:
a.	Move to the next section.
6.	Go to the “Concentration” section:
a.	For each row in this section with data:
i.	Find the corresponding data point in the source file(s).
ii.	If it does not match:
1.	Navigate to the “OriginalData” tab.
2.	Find the corresponding data stream.
3.	Ensure that the coding for that row is correct.
4.	Ensure that the data for that row matches the data in the source file(s).
iii.	If it matches:
1.	Move to the next section.

Passing the Stage:

d.	Go to the “Control” tab. (You can click the “Control” button at the top of the “Validation” tab for quick access.)
e.	Ensure that the correct inputs have been entered:
i.	Client Code
ii.	Fund Code
iii.	Date
iv.	Analyst Name
v.	Number of Months to export
vi.	Stage
f.	Ensure that “PASS/FAIL” is set to “PASS.”
g.	Click “Submit Pass/Fail.”
h.	At the prompt that says “[Your name] is about to submit a PASS, are you sure?”, click “Yes.”


